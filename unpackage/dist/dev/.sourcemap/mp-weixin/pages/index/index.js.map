{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/uu/Documents/HBuilderProjects/miao/pages/index/index.vue?11f9","webpack:///C:/Users/uu/Documents/HBuilderProjects/miao/pages/index/index.vue?8f0d","webpack:///C:/Users/uu/Documents/HBuilderProjects/miao/pages/index/index.vue?287b","uni-app:///pages/index/index.vue","webpack:///C:/Users/uu/Documents/HBuilderProjects/miao/pages/index/index.vue?51b9","webpack:///C:/Users/uu/Documents/HBuilderProjects/miao/pages/index/index.vue?5bce"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","row","id","type","layerIdx","rowIdx","colIdx","dark","layer","data","created","components","StateBar","gameName","gameStartTime","pauseTimeStart","pauseTime","gameTime","currentTime","cards","bar","score","audioOn","xipaiFlag","xipaiLeft","pauseLeft","show","welcome","gameover","watch","timeRemain","computed","rv","gameNameDisplay","height","width","arr","char","style","left","top","transform","mainPanelClass","classes","cardMarginLeft","cardWidth","columnCount","cardHeight","barMarginLeft","onLoad","that","bgm","failed","sua","du","onUnload","clearTimeout","methods","cardInMatrix","console","uncover","currCard","needCheckCards","cardNeedCheck","cardClicked","grouped","destoryQueue","setTimeout","cardInGroup","barItemCnt","pauseClicked","deleteCardInBar","newBar","getCardPositionInBar","cardStyle","offsetX","offsetY","cy","cx","tan","xipaiClicked","card","startGame","restartGame","newGame"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,cAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACa;;;AAGjE;AAC4K;AAC5K,gBAAgB,6KAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACpDA;AAAA;AAAA;AAAA;AAA+oB,CAAgB,+mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;AC8DnqB;AACA;AAEA;EACA;EAEA;EACA;IACA;IAEA;MACA;MACA;QACAC;UACAC;UACAC;UACAC;UACAC;UACAC;UACAC;QACA;QACAL;MACA;MACAM;IACA;IACAC;EACA;EACA;AACA;AAAA,eAGA;EACAC;EACAC;IACAC;EACA;EACAH;IACA;MACAI;MAEAC;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MAEAC;MAEAC;MACAC;MAEAC;MAEAC;QACAC;QACAC;MACA;IACA;EACA;EACAC;IACAP;MACA;QACA;MACA;QACA;MACA;IACA;IACAQ;MACA;QACA;MACA;MACA;QACA;MAAA;MAEA;QACA;MAAA;MAEA;QACA;MACA;IACA;EACA;EACAC;IACAD;MACA,IACAhB,gBAKA,KALAA;QACAI,cAIA,KAJAA;QACAF,YAGA,KAHAA;QACAD,iBAEA,KAFAA;QACAE,WACA,KADAA;MAEA;MACA;QAAA;QACAe;MACA;QACAA;MACA;MACA;IACA;IAEAC;MACA,IACApB,WAGA,KAHAA;QACAqB,SAEA,KAFAA;QACAC,QACA,KADAA;MAEA;MAGA;MACA;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;QACA;QACA;QAEA;QACAC;UACAC;UACAC;YACAC;YACAC;YACAC;YACA;UACA;QACA;MACA;MACA;IACA;IACAC;MACA,iBAGA;QAFAf;QACAC;MAEA;MACA;QACAe;MACA;MACA;QACAA;MACA;MAEA;IACA;IACAC;MACA,IACAC,YAGA,KAHAA;QACAC,cAEA,KAFAA;QACAX,QACA,KADAA;MAEA;IACA;IACAA;MACA;IACA;IACAD;MACA;IACA;IACAa;MACA,IACAb,SACA,KADAA;MAEA;IACA;IACAW;MACA,IACAV,QACA,KADAA;MAEA;IACA;IACAW;MACA,IACAX,QAEA,KAFAA;QACAU,YACA,KADAA;MAEA;IACA;IACAG;MACA,IACAb,QAEA,KAFAA;QACAU,YACA,KADAA;MAEA;IACA;EACA;EACAI;IACA;IACAC;MACA;QACA;MACA;MACAA;IACA;IAEAA;MACAC;MACAC;MACAC;MACAC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EAEA;EACAC;IACAC;EACA;EACAC;IACAC;MACA;MACA;MACA;QACA;QACA;UACA;UACA;YACAzD;YACA;YACA0D;UACA;UACA;YACA;UACA;QACA;MACA;MACA;IACA;IACAC;MAAA;MAAA;MACA;MAEA;QAAA;QACA;QACA;UACA;QACA;QAEA;UACA;QACA;QAEA;UACA;QACA;QAEA;MACA;MAEA;QAAA;QACA;UAAA;UACAxD;UACAC;UACAC;QACA;UACAF;UACAC;UACAC;QACA;UACAF;UACAC;UACAC;QACA;UACAF;UACAC;UACAC;QACA;UACA;UACA;QACA;QAEA;UACA;UACA;UACA;UACA;UACA;YACAuD;YACAX;UACA;QACA;QAEAY;UACAC;QACA;MAGA;QAAA;QACA;UAAA;UACA3D;UACAC;UACAC;QACA;UACAF;UACAC;UACAC;QACA;UACAF;UACAC;UACAC;QACA;UACAF;UACAC;UACAC;QACA;UACA;UACA;QACA;QAEA;UACA;UACA;UACA;UACA;UACA;YACAuD;YACAX;UACA;QACA;QAEAY;UACAC;QACA;MACA;IACA;IACAC;MACA;QAAA;QACA;MACA;MAEA;QACA;MACA;MAEA;QACA;MACA;MAEA;QACA;MACA;MAEA;MAEA;QACA;MACA;MAEA;QAAA;QACA;MACA;MAEA;QACA;MACA;MAEAd;MAEAA;MACAA;QACA;MACA;MAEAA;MAEA;MACA;MAAA,2CACAA;QAAA;MAAA;QAAA;UAAA;UACA;YACAe;UACA;UACAA;QACA;MAAA;QAAA;MAAA;QAAA;MAAA;MACA;QACA;QACA;UACA;YACAC;UACA;UACAhB;UACAiB;YACAjB;YACAgB;cACAE;cACAlB,wEACA5C;cACA4C;YAEA;UACA;QACA;MACA;MAEA;MACAA;QACA;UACA;QACA;QACA;UACAmB;QACA;MACA;MACA;QACAnB;MACA;IACA;IACAoB;MACA;QACA;UACA;QACA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MACA;MAEA;QACA;QACA;UACAC;QACA;MACA;MAEA;IACA;IACAC;MACA,IACArD,MAIA,KAJAA;QACAc,SAGA,KAHAA;QACAW,YAEA,KAFAA;QACAG,gBACA,KADAA;MAGA;MACA;QACA;UACAT;UACA;QACA;MACA;MAEA;QACAC;QACAD;MACA;IACA;IACAmC;MAEA;QACA;MACA;MACA;QAAA;QACA;QACA;UACAlC;UACAD;UACA;QACA;QACA;MACA;MAEA,IACAJ,QAIA,KAJAA;QACAD,SAGA,KAHAA;QACAW,YAEA,KAFAA;QACAE,aACA,KADAA;MAGA;MACA;MACA;QACA4B;QACAC;MACA;MACA;MACA;MAEA;MACA;MAEA;QAAA;QACA;QACA;QAEA;QACA;QAEA;UACAC;QACA;QACA;UACAC;QACA;QACA;QACA;;QAEA;QAEA;UACAC;QACA;UACAA;QACA;QAEA;UAAA;UACAxC;UAEA;YAAA;YACAC;UACA;YAAA;YACAA;UACA;QAEA;UAAA;UACAD;UAEA;YAAA;YACAC;UACA;YAAA;YACAA;UACA;QACA;QAEA;UACAA;UACAD;QACA;MACA;MAIA;QACAC;QACAD;MACA;IACA;IACAyC;MACA;MAEA;QACA;MACA;MACA;QACA;MACA;MAEA9B;MACAA;MAEAiB;QACAjB;QACA,IACA/B,QACA+B,KADA/B;QACA,4CACAA;UAAA;QAAA;UAAA;YAAA;YAAA,4CACAX;cAAA;YAAA;cAAA;gBAAA;gBAAA,4CACAP;kBAAA;gBAAA;kBAAA;oBAAA;oBACA;sBACA;oBACA;oBACA;sBAAA;sBACAgF;oBACA;kBAAA;kBANA;oBAAA;kBAQA;gBAAA;kBAAA;gBAAA;kBAAA;gBAAA;cACA;YAAA;cAAA;YAAA;cAAA;YAAA;UACA;QAAA;UAAA;QAAA;UAAA;QAAA;MACA;IACA;IACArD;MACA;MACA;MACA;MACAsB;IACA;IACAgC;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA,IACAtC,cACAI,KADAJ;MAIAI;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACAA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACvqBA;AAAA;AAAA;AAAA;AAAo7B,CAAgB,o2BAAG,EAAC,C;;;;;;;;;;;ACAx8B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=57280228&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var l2 = _vm.__map(_vm.cards, function (layer, layerIdx) {\n    var $orig = _vm.__get_orig(layer)\n    var l1 = _vm.cards\n      ? _vm.__map(layer, function (row, rowIdx) {\n          var $orig = _vm.__get_orig(row)\n          var l0 = _vm.__map(row, function (card, cardIdx) {\n            var $orig = _vm.__get_orig(card)\n            var s0 =\n              card && !card.destory\n                ? _vm.__get_style([_vm.cardStyle(card)])\n                : null\n            return {\n              $orig: $orig,\n              s0: s0,\n            }\n          })\n          return {\n            $orig: $orig,\n            l0: l0,\n          }\n        })\n      : null\n    return {\n      $orig: $orig,\n      l1: l1,\n    }\n  })\n  var l3 = _vm.__map(_vm.gameNameDisplay, function (item, idx) {\n    var $orig = _vm.__get_orig(item)\n    var s1 = _vm.__get_style([item.style])\n    return {\n      $orig: $orig,\n      s1: s1,\n    }\n  })\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        l2: l2,\n        l3: l3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"main-panel\" :class=\"mainPanelClass\">\r\n\t\t<template v-if='cards' v-for=\"(layer,layerIdx) in cards\">\r\n\t\t\t<template v-for=\"(row,rowIdx) in layer\">\r\n\t\t\t\t<template v-for=\"(card, cardIdx) in row\">\r\n\t\t\t\t\t<view v-if='card && !card.destory' class=\"card-item\" :class='{dark: card.dark || pauseTimeStart !== 0}' :style=\"[cardStyle(card)]\" ref=\"mainPanelRef\"\r\n\t\t\t\t\t\t@click=\"cardClicked(card)\">\r\n\t\t\t\t\t\t<image v-if='card.type === 0' src=\"../../static/0.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 1' src=\"../../static/1.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 2' src=\"../../static/2.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 3' src=\"../../static/3.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 4' src=\"../../static/4.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 5' src=\"../../static/5.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 6' src=\"../../static/6.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 7' src=\"../../static/7.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 8' src=\"../../static/8.png\" />\r\n\t\t\t\t\t\t<image v-if='card.type === 9' src=\"../../static/9.png\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</template>\r\n\t\t\t</template>\r\n\t\t</template>\r\n\r\n\t\t<view class=\"xipai-btn control-btn\" @click='xipaiClicked'>\r\n\t\t\t<view class='corner'>{{xipaiLeft}}</view>\r\n\t\t\t<text>洗牌</text>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"zhanting control-btn\" @click=\"pauseClicked\">\r\n\t\t\t{{pauseTimeStart === 0 ? \"暂停\" : \"继续\"}}\r\n\t\t\t<view class=\"corner\">{{pauseLeft}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<state-bar :time-remain=\"timeRemain\" :score=\"score\" :hidden='show.welcome' />\r\n\r\n\t\t<view class=\"welcome\">\r\n\t\t\t<view class=\"game-name\" v-for=\"(item, idx) of gameNameDisplay\" :key=\"idx\" :style=\"[item.style]\">\r\n\t\t\t\t{{item.char}}\r\n\t\t\t</view>\r\n\t\t\t<view class=\"start-button\" @click=\"startGame\">开始游戏</view>\r\n\t\t</view>\r\n\r\n\r\n\r\n\t\t<div class=\"game-over-mask\">\r\n\t\t\t<div class=\"text\">游戏结束</div>\r\n\t\t\t<div class=\"start-button\" @click=\"restartGame\">重新开始</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"bar\"></div>\r\n\r\n\t\t<div class=\"water-mark link\">\r\n\t\t\thttp://tsy.zone/site/home\r\n\t\t</div>\r\n\t</view>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\n\timport StateBar from './state-bar.vue'\r\n\r\n\tconst BAR_LENGTH = 8;\r\n\tconst CARD_TYPE = 9\r\n\r\n\tconst createCardsData = (layerCnt, rowCnt, columnCnt, typeCnt) => {\r\n\t\tlet id = 1;\r\n\r\n\t\tconst data = [];\r\n\t\tfor (let layerIdx = 0; layerIdx < layerCnt; layerIdx++) {\r\n\t\t\tconst layer = []\r\n\r\n\t\t\tfor (let rowIdx = 0; rowIdx < rowCnt - layerIdx % 2; rowIdx++) {\r\n\t\t\t\tconst row = []\r\n\t\t\t\tfor (let colIdx = 0; colIdx < columnCnt - layerIdx % 2; colIdx++) {\r\n\t\t\t\t\trow.push({\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\ttype: Math.floor(Math.random() * typeCnt),\r\n\t\t\t\t\t\tlayerIdx,\r\n\t\t\t\t\t\trowIdx,\r\n\t\t\t\t\t\tcolIdx,\r\n\t\t\t\t\t\tdark: layerIdx !== layerCnt - 1,\r\n\t\t\t\t\t})\r\n\t\t\t\t\tid++;\r\n\t\t\t\t}\r\n\t\t\t\tlayer.push(row)\r\n\t\t\t}\r\n\t\t\tdata.push(layer)\r\n\t\t}\r\n\t\treturn data;\r\n\t}\r\n\r\n\r\n\texport default {\r\n\t\tcreated() {},\r\n\t\tcomponents: {\r\n\t\t\tStateBar\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tgameName: '喵了个咪',\r\n\r\n\t\t\t\tgameStartTime: 0,\r\n\t\t\t\tpauseTimeStart: 0,\r\n\t\t\t\tpauseTime: 0,\r\n\t\t\t\tgameTime: 0,\r\n\t\t\t\tcurrentTime: 0,\r\n\r\n\t\t\t\tcards: false,\r\n\t\t\t\tbar: [],\r\n\t\t\t\tscore: 0,\r\n\r\n\t\t\t\taudioOn: true,\r\n\r\n\t\t\t\txipaiFlag: false,\r\n\t\t\t\txipaiLeft: 3,\r\n\r\n\t\t\t\tpauseLeft: 3,\r\n\r\n\t\t\t\tshow: {\r\n\t\t\t\t\twelcome: true,\r\n\t\t\t\t\tgameover: false\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\taudioOn(value) {\r\n\t\t\t\tif (value) {\r\n\t\t\t\t\tthis.$refs.audioBgmRef.play()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$refs.audioBgmRef.pause()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttimeRemain(remain) {\r\n\t\t\t\tif (this.show.welcome || this.show.gameover) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (remain === 6) {\r\n\t\t\t\t\t// this.$refs.audioBgmRef.pause()\r\n\t\t\t\t}\r\n\t\t\t\tif (remain === 5 || remain === 4 || remain === 3 || remain === 2 || remain === 1) {\r\n\t\t\t\t\t// this.audioOn && this.$refs.audioDuRef.play();\r\n\t\t\t\t}\r\n\t\t\t\tif (remain <= 0) {\r\n\t\t\t\t\tthis.gameover()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\ttimeRemain() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tgameStartTime,\r\n\t\t\t\t\tcurrentTime,\r\n\t\t\t\t\tpauseTime,\r\n\t\t\t\t\tpauseTimeStart,\r\n\t\t\t\t\tgameTime,\r\n\t\t\t\t} = this\r\n\t\t\t\tlet rv = 0\r\n\t\t\t\tif (pauseTimeStart === 0) { // 当前没有暂停\r\n\t\t\t\t\trv = gameTime - (currentTime - gameStartTime) / 1000 + pauseTime\r\n\t\t\t\t} else {\r\n\t\t\t\t\trv = gameTime - (pauseTimeStart - gameStartTime) / 1000 + pauseTime\r\n\t\t\t\t}\r\n\t\t\t\treturn Math.floor(rv)\r\n\t\t\t},\r\n\r\n\t\t\tgameNameDisplay() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tgameName,\r\n\t\t\t\t\theight,\r\n\t\t\t\t\twidth\r\n\t\t\t\t} = this;\r\n\t\t\t\tconst arr = []\r\n\r\n\r\n\t\t\t\tconst fs = Math.min(width, height) / (gameName.length)\r\n\t\t\t\tconst offsetX = width / (gameName.length + 1)\r\n\t\t\t\tconst centerX = width / 2\r\n\t\t\t\tconst centerY = height / 2\r\n\t\t\t\tconst radius = Math.min(width, height) / 2\r\n\t\t\t\tconst deg = 60\r\n\t\t\t\tfor (let idx = 0; idx < gameName.length; idx++) {\r\n\t\t\t\t\tconst char = gameName.charAt(idx);\r\n\t\t\t\t\tconst left = offsetX * (idx + 1)\r\n\t\t\t\t\tconst a = centerX - left\r\n\t\t\t\t\tconst topOffset = Math.sqrt(radius * radius - a * a)\r\n\t\t\t\t\tlet top = centerY - topOffset\r\n\r\n\t\t\t\t\tconst rot = deg / (gameName.length - 1) * (idx) - deg / 2\r\n\t\t\t\t\tarr.push({\r\n\t\t\t\t\t\tchar,\r\n\t\t\t\t\t\tstyle: {\r\n\t\t\t\t\t\t\tleft: `${left}rpx`,\r\n\t\t\t\t\t\t\ttop: `${top}rpx`,\r\n\t\t\t\t\t\t\ttransform: `rotate(${rot}deg) translateX(-50%)`,\r\n\t\t\t\t\t\t\t'font-size': `${fs}rpx`\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\treturn arr;\r\n\t\t\t},\r\n\t\t\tmainPanelClass() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\twelcome,\r\n\t\t\t\t\tgameover\r\n\t\t\t\t} = this.show\r\n\t\t\t\tconst classes = []\r\n\t\t\t\tif (welcome) {\r\n\t\t\t\t\tclasses.push('show-welcome')\r\n\t\t\t\t}\r\n\t\t\t\tif (gameover) {\r\n\t\t\t\t\tclasses.push('show-game-over')\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn classes\r\n\t\t\t},\r\n\t\t\tcardMarginLeft() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcardWidth,\r\n\t\t\t\t\tcolumnCount,\r\n\t\t\t\t\twidth\r\n\t\t\t\t} = this\r\n\t\t\t\treturn (width - cardWidth * columnCount) / 2\r\n\t\t\t},\r\n\t\t\twidth() {\r\n\t\t\t\treturn 750;\r\n\t\t\t},\r\n\t\t\theight() {\r\n\t\t\t\treturn 1334;\r\n\t\t\t},\r\n\t\t\tcardHeight() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\theight\r\n\t\t\t\t} = this\r\n\t\t\t\treturn Math.floor(height / 10);\r\n\t\t\t},\r\n\t\t\tcardWidth() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\twidth\r\n\t\t\t\t} = this\r\n\t\t\t\treturn Math.floor(width / 9)\r\n\t\t\t},\r\n\t\t\tcolumnCount() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\tcardWidth\r\n\t\t\t\t} = this\r\n\t\t\t\treturn Math.floor(width * 0.95 / cardWidth)\r\n\t\t\t},\r\n\t\t\tbarMarginLeft() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\tcardWidth,\r\n\t\t\t\t} = this\r\n\t\t\t\treturn (width - cardWidth * BAR_LENGTH) / 2;\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tconst that = this\r\n\t\t\tthat.timerId = setInterval(() => {\r\n\t\t\t\tif (that.show.gameover || that.show.welcome) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tthat.currentTime = Date.now()\r\n\t\t\t}, 100)\r\n\r\n\t\t\tthat.audio = {\r\n\t\t\t\tbgm: uni.createInnerAudioContext(),\r\n\t\t\t\tfailed: uni.createInnerAudioContext(),\r\n\t\t\t\tsua: uni.createInnerAudioContext(),\r\n\t\t\t\tdu: uni.createInnerAudioContext(),\r\n\t\t\t}\r\n\t\t\t// that.audio.bgm.src = \"../../static/bgm.mp3\";\r\n\t\t\t// that.audo.bgm.loop = true;\r\n\t\t\t// that.audio.bgm.play();\r\n\t\t\t// that.audio.failed.src = \"../../static/failed.mp3\";\r\n\t\t\t// that.audio.sua.src = \"../../static/sua.mp3\";\r\n\t\t\t// that.audio.du.src = \"../../static/du.mp3\";\r\n\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tclearTimeout(this.timerId)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tcardInMatrix(layerIdx, rowIdx, colIdx, newValue) {\r\n\t\t\t\tconst cards = JSON.parse(JSON.stringify(this.cards));\r\n\t\t\t\tconst layer = cards[layerIdx];\r\n\t\t\t\tif (layer) {\r\n\t\t\t\t\tconst row = layer[rowIdx];\r\n\t\t\t\t\tif (row) {\r\n\t\t\t\t\t\tconst card = row[colIdx]\r\n\t\t\t\t\t\tif (newValue !== undefined) {\r\n\t\t\t\t\t\t\trow[colIdx] = newValue\r\n\t\t\t\t\t\t\tthis.cards = cards\r\n\t\t\t\t\t\t\tconsole.log(`set matrix L[${layerIdx}] R[${rowIdx}] C[${colIdx}] to new value`, newValue)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (card) {\r\n\t\t\t\t\t\t\treturn card\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tuncover(card) { // 翻开底部, 奇偶错位，分别处理\r\n\t\t\t\tconst that = this\r\n\r\n\t\t\t\tconst removed = (layerIdx, rowIdx, colIdx) => { // 被destory  或者 在 bar中 都是从 matrix中移除 了\r\n\t\t\t\t\tconst card = this.cardInMatrix(layerIdx, rowIdx, colIdx)\r\n\t\t\t\t\tif (card === false) {\r\n\t\t\t\t\t\treturn true\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (card.destory) {\r\n\t\t\t\t\t\treturn card\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst cardInBar = that.bar.find(cardInBar => {\r\n\t\t\t\t\t\treturn cardInBar.id === card.id\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\treturn cardInBar\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (card.layerIdx % 2 === 0) { // 偶数层数据多\r\n\t\t\t\t\tconst needCheckCards = [{ // 上一层相邻的4张牌\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx - 1,\r\n\t\t\t\t\t\tcolIdx: card.colIdx - 1\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx - 1,\r\n\t\t\t\t\t\tcolIdx: card.colIdx\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx,\r\n\t\t\t\t\t\tcolIdx: card.colIdx - 1\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx,\r\n\t\t\t\t\t\tcolIdx: card.colIdx\r\n\t\t\t\t\t}].map(pos => {\r\n\t\t\t\t\t\tconst currCard = that.cardInMatrix(pos.layerIdx, pos.rowIdx, pos.colIdx)\r\n\t\t\t\t\t\treturn currCard\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconst check = currCard => {\r\n\t\t\t\t\t\tconst c1Removed = removed(currCard.layerIdx + 1, currCard.rowIdx, currCard.colIdx);\r\n\t\t\t\t\t\tconst c2Removed = removed(currCard.layerIdx + 1, currCard.rowIdx, currCard.colIdx + 1);\r\n\t\t\t\t\t\tconst c3Removed = removed(currCard.layerIdx + 1, currCard.rowIdx + 1, currCard.colIdx)\r\n\t\t\t\t\t\tconst c4Removed = removed(currCard.layerIdx + 1, currCard.rowIdx + 1, currCard.colIdx + 1)\r\n\t\t\t\t\t\tif (c1Removed && c2Removed && c3Removed && c4Removed) {\r\n\t\t\t\t\t\t\tcurrCard.dark = false\r\n\t\t\t\t\t\t\tthat.cardInMatrix(currCard.layerIdx, currCard.rowIdx, currCard.colIdx, currCard)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tneedCheckCards.forEach(cardNeedCheck => {\r\n\t\t\t\t\t\tcardNeedCheck && check(cardNeedCheck)\r\n\t\t\t\t\t})\r\n\r\n\r\n\t\t\t\t} else { // 奇数层\r\n\t\t\t\t\tconst needCheckCards = [{ // 上一层相邻的4张牌\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx,\r\n\t\t\t\t\t\tcolIdx: card.colIdx\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx + 1,\r\n\t\t\t\t\t\tcolIdx: card.colIdx\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx,\r\n\t\t\t\t\t\tcolIdx: card.colIdx + 1\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\tlayerIdx: card.layerIdx - 1,\r\n\t\t\t\t\t\trowIdx: card.rowIdx + 1,\r\n\t\t\t\t\t\tcolIdx: card.colIdx + 1\r\n\t\t\t\t\t}].map(pos => {\r\n\t\t\t\t\t\tconst currCard = that.cardInMatrix(pos.layerIdx, pos.rowIdx, pos.colIdx)\r\n\t\t\t\t\t\treturn currCard\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\tconst check = currCard => {\r\n\t\t\t\t\t\tconst c1Removed = removed(currCard.layerIdx + 1, currCard.rowIdx - 1, currCard.colIdx - 1);\r\n\t\t\t\t\t\tconst c2Removed = removed(currCard.layerIdx + 1, currCard.rowIdx - 1, currCard.colIdx);\r\n\t\t\t\t\t\tconst c3Removed = removed(currCard.layerIdx + 1, currCard.rowIdx, currCard.colIdx - 1)\r\n\t\t\t\t\t\tconst c4Removed = removed(currCard.layerIdx + 1, currCard.rowIdx, currCard.colIdx)\r\n\t\t\t\t\t\tif (c1Removed && c2Removed && c3Removed && c4Removed) {\r\n\t\t\t\t\t\t\tcurrCard.dark = false\r\n\t\t\t\t\t\t\tthat.cardInMatrix(currCard.layerIdx, currCard.rowIdx, currCard.colIdx, currCard)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tneedCheckCards.forEach(cardNeedCheck => {\r\n\t\t\t\t\t\tcardNeedCheck && check(cardNeedCheck)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcardClicked(card) {\r\n\t\t\t\tif (card.dark) { // 黑牌不能点击\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.xipaiFlag) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.pauseTimeStart !== 0) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.show.gameover) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst that = this\r\n\r\n\t\t\t\tconst cardInBarBeforePush = that.bar.find(cib => {\r\n\t\t\t\t\treturn cib.id === card.id\r\n\t\t\t\t})\r\n\r\n\t\t\t\tif (cardInBarBeforePush) { // 已经在bar中的不能点击\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (that.bar.length === BAR_LENGTH) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthat.audioOn && that.audio.sua.play();\r\n\r\n\t\t\t\tthat.bar.push(card)\r\n\t\t\t\tthat.bar.sort((a, b) => {\r\n\t\t\t\t\treturn a.type - b.type\r\n\t\t\t\t})\r\n\r\n\t\t\t\tthat.uncover(card)\r\n\r\n\t\t\t\tconst destoryQueue = []\r\n\t\t\t\tconst grouped = []\r\n\t\t\t\tfor (const cardInBar of that.bar) {\r\n\t\t\t\t\tif (!grouped[cardInBar.type]) {\r\n\t\t\t\t\t\tgrouped[cardInBar.type] = []\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgrouped[cardInBar.type].push(cardInBar)\r\n\t\t\t\t}\r\n\t\t\t\tfor (const key in grouped) {\r\n\t\t\t\t\tconst cardGroup = grouped[key]\r\n\t\t\t\t\tif (cardGroup.length >= 3) {\r\n\t\t\t\t\t\tfor (let destoryIdx = 0; destoryIdx < 3; destoryIdx++) {\r\n\t\t\t\t\t\t\tdestoryQueue.push(cardGroup[destoryIdx])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthat.gameTime += 5\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthat.score += 1;\r\n\t\t\t\t\t\t\tdestoryQueue.forEach(cardInGroup => {\r\n\t\t\t\t\t\t\t\tcardInGroup.destory = true\r\n\t\t\t\t\t\t\t\tthat.cardInMatrix(cardInGroup.layerIdx, cardInGroup.rowIdx, cardInGroup\r\n\t\t\t\t\t\t\t\t\t.colIdx, cardInGroup)\r\n\t\t\t\t\t\t\t\tthat.deleteCardInBar(cardInGroup.id)\r\n\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet barItemCnt = 0\r\n\t\t\t\tthat.bar.forEach(cardInBar => {\r\n\t\t\t\t\tconst needDestory = destoryQueue.find(cardInDestory => {\r\n\t\t\t\t\t\treturn cardInBar.id === cardInDestory.id\r\n\t\t\t\t\t})\r\n\t\t\t\t\tif (!needDestory) {\r\n\t\t\t\t\t\tbarItemCnt++\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tif (barItemCnt > BAR_LENGTH - 1) {\r\n\t\t\t\t\tthat.gameover()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tpauseClicked() {\r\n\t\t\t\tif (this.pauseTimeStart === 0) {\r\n\t\t\t\t\tif (this.pauseLeft <= 0) {\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.pauseLeft -= 1\r\n\t\t\t\t\tthis.pauseTimeStart = Date.now()\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.pauseTime += (Date.now() - this.pauseTimeStart) / 1000\r\n\t\t\t\t\tthis.pauseTimeStart = 0\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdeleteCardInBar(cardId) {\r\n\t\t\t\tconst newBar = []\r\n\r\n\t\t\t\tfor (let idx = 0; idx < this.bar.length; idx++) {\r\n\t\t\t\t\tconst cardInBar = this.bar[idx];\r\n\t\t\t\t\tif (cardInBar && cardInBar.id !== cardId) {\r\n\t\t\t\t\t\tnewBar.push(cardInBar)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.bar = newBar\r\n\t\t\t},\r\n\t\t\tgetCardPositionInBar(cardId) {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tbar,\r\n\t\t\t\t\theight,\r\n\t\t\t\t\tcardWidth,\r\n\t\t\t\t\tbarMarginLeft\r\n\t\t\t\t} = this\r\n\r\n\t\t\t\tlet left = 0;\r\n\t\t\t\tfor (let idx = 0; idx < bar.length; idx++) {\r\n\t\t\t\t\tif (bar[idx].id === cardId) {\r\n\t\t\t\t\t\tleft = Math.floor(idx * cardWidth + barMarginLeft)\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttop: Math.floor(height * 0.9),\r\n\t\t\t\t\tleft\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcardStyle(card) {\r\n\t\t\t\t\r\n\t\t\t\tconst cardInBar = this.bar.find(cardInBar => {\r\n\t\t\t\t\treturn cardInBar && cardInBar.id === card.id\r\n\t\t\t\t})\r\n\t\t\t\tif (cardInBar) { // 已经加入bar，用bar中的位置\r\n\t\t\t\t\tconst pos = this.getCardPositionInBar(card.id)\r\n\t\t\t\t\tconst style = {\r\n\t\t\t\t\t\ttop: `${pos.top}rpx`,\r\n\t\t\t\t\t\tleft: `${pos.left}rpx`,\r\n\t\t\t\t\t\t'z-index': 100000 + card.layerIdx,\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn style;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst {\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\theight,\r\n\t\t\t\t\tcardWidth,\r\n\t\t\t\t\tcardHeight\r\n\t\t\t\t} = this\r\n\r\n\t\t\t\tlet offsetX = 0;\r\n\t\t\t\tlet offsetY = 0;\r\n\t\t\t\tif (card.layerIdx % 2 === 1) {\r\n\t\t\t\t\toffsetX = cardWidth / 2\r\n\t\t\t\t\toffsetY = cardHeight / 2\r\n\t\t\t\t}\r\n\t\t\t\tconst leftValue = card.colIdx * this.cardWidth + this.cardMarginLeft + offsetX\r\n\t\t\t\tconst topValue = card.rowIdx * this.cardHeight + this.cardHeight + offsetY\r\n\r\n\t\t\t\tlet top = topValue\r\n\t\t\t\tlet left = leftValue\r\n\r\n\t\t\t\tif (this.xipaiFlag) { // 如果当前正在洗牌，\r\n\t\t\t\t\tconst centerX = width / 2\r\n\t\t\t\t\tconst centerY = height / 2\r\n\r\n\t\t\t\t\tlet cx = left + cardWidth / 2\r\n\t\t\t\t\tlet cy = top + cardHeight / 2\r\n\r\n\t\t\t\t\tif (cy === centerY) {\r\n\t\t\t\t\t\tcy = +1\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (cx === centerX) {\r\n\t\t\t\t\t\tcx += 1\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst b = centerY - cy // >0 上面    <0 下面\r\n\t\t\t\t\tconst a = centerX - cx // >0左面     <0 右面\r\n\r\n\t\t\t\t\tlet tan = b / a\r\n\r\n\t\t\t\t\tif (tan > 20) {\r\n\t\t\t\t\t\ttan = 20\r\n\t\t\t\t\t} else if (tan < -20) {\r\n\t\t\t\t\t\ttan = -20\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (cx <= centerX) { // 左面\r\n\t\t\t\t\t\tleft = centerX - width\r\n\r\n\t\t\t\t\t\tif (cy <= centerY) { // 4\r\n\t\t\t\t\t\t\ttop = left * tan\r\n\t\t\t\t\t\t} else { // 3\r\n\t\t\t\t\t\t\ttop = left * tan + centerY\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else { // 右面\r\n\t\t\t\t\t\tleft = centerX + width\r\n\r\n\t\t\t\t\t\tif (cy <= centerY) { // 1\r\n\t\t\t\t\t\t\ttop = left * tan\r\n\t\t\t\t\t\t} else { // 2\r\n\t\t\t\t\t\t\ttop = left * tan\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttop: `${top}rpx`,\r\n\t\t\t\t\t\tleft: `${left}rpx`,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttop: `${topValue}rpx`,\r\n\t\t\t\t\tleft: `${leftValue}rpx`,\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\txipaiClicked() {\r\n\t\t\t\tconst that = this\r\n\r\n\t\t\t\tif (that.xipaiLeft <= 0) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (that.xipaiFlag) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthat.xipaiFlag = true\r\n\t\t\t\tthat.xipaiLeft -= 1\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthat.xipaiFlag = false\r\n\t\t\t\t\tconst {\r\n\t\t\t\t\t\tcards\r\n\t\t\t\t\t} = that\r\n\t\t\t\t\tfor (const layer of cards) {\r\n\t\t\t\t\t\tfor (const row of layer) {\r\n\t\t\t\t\t\t\tfor (const card of row) {\r\n\t\t\t\t\t\t\t\tconst cardInBar = that.bar.find(cardInBar => {\r\n\t\t\t\t\t\t\t\t\treturn cardInBar && cardInBar.id === card.id\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tif (!cardInBar && !card.destory) { // 已经加入bar，用bar中的位置, 只能变换不在bar中的card\r\n\t\t\t\t\t\t\t\t\tcard.type = Math.floor(Math.random() * CARD_TYPE)\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 1000)\r\n\t\t\t},\r\n\t\t\tgameover() {\r\n\t\t\t\tconst that = this\r\n\t\t\t\t// that.$refs.audioBgmRef.pause()\r\n\t\t\t\t// that.audioOn && that.$refs.audioFailedRef.play()\r\n\t\t\t\tthat.show.gameover = true\r\n\t\t\t},\r\n\t\t\tstartGame() {\r\n\t\t\t\tthis.show.welcome = false\r\n\t\t\t\tthis.newGame()\r\n\t\t\t},\r\n\t\t\trestartGame() {\r\n\t\t\t\tthis.newGame()\r\n\t\t\t},\r\n\t\t\tnewGame() {\r\n\t\t\t\tconst that = this\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcolumnCount\r\n\t\t\t\t} = that\r\n\r\n\r\n\t\t\t\tthat.cards = createCardsData(2, 7, columnCount, 6)\r\n\t\t\t\tthat.gameStartTime = Date.now()\r\n\t\t\t\tthat.gameTime = 1000;\r\n\t\t\t\tthat.pauseTime = 0;\r\n\t\t\t\tthat.pauseTimeStart = 0;\r\n\t\t\t\tthat.show.gameover = false\r\n\t\t\t\tthat.bar = []\r\n\t\t\t\tthat.score = 0\r\n\t\t\t\t// that.audioOn && that.$refs.audioBgmRef.play()\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.main-panel {\r\n\t\t--width: 750rpx;\r\n\t\t--height: 1334rpx;\r\n\t\t--card-height: calc(var(--height) / 10 - 10rpx);\r\n\t\t--card-width: calc(var(--width) / 9);\r\n\t\t--bar-length: 8;\r\n\t\t--bar-left: calc((var(--width) - var(--card-width) * var(--bar-length)) / 2);\r\n\t\t--bar-top: calc(var(--height) * 0.9);\r\n\t\t--welcome-z: 1000000;\r\n\t\t--speaker-z: calc(var(--welcome-z) + 1);\r\n\t\t--game-over-z: calc(var(--speaker-z) + 1);\r\n\t\t--water-mark-z: calc(var(--speaker-z) + 1);\r\n\r\n\t\toverflow: hidden;\r\n\t\theight: 100vh;\r\n\t\twidth: var(--width);\r\n\t\tposition: relative;\r\n\t\tbackground: linear-gradient(190deg, hsl(250, 100%, 65%), hsl(200, 100%, 65%), hsl(100, 100%, 64%))\r\n\t}\r\n\r\n\t.card-item {\r\n\t\tdisplay: inline-block;\r\n\t\tposition: absolute;\r\n\t\twidth: var(--card-width);\r\n\t\theight: var(--card-height);\r\n\t\tborder: 1rpx solid red;\r\n\t\ttransition: all 1s;\r\n\r\n\t}\r\n\r\n\t.card-item.dark {\r\n\t\tfilter: brightness(.3);\r\n\t}\r\n\r\n\t.card-item>image {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.control-btn {\r\n\t\tposition: absolute;\r\n\t\tfont-size: calc(var(--card-width) * .3);\r\n\t\tpadding: calc(var(--card-width) * .15);\r\n\t\tbackground: linear-gradient(#eee, white, #eee);\r\n\t\tborder-radius: calc(var(--card-width) * .2);\r\n\t\tcursor: pointer;\r\n\t\tcolor: rgb(77, 73, 73);\r\n\t\tborder: 1rpx solid gray;\r\n\t\t--box-shadow-size: calc(var(--card-width) * .05);\r\n\t\tbox-shadow: var(--box-shadow-size) var(--box-shadow-size) var(--box-shadow-size) gray;\r\n\t\ttop: calc(var(--height) * 0.82);\r\n\t}\r\n\r\n\t.xipai-btn {\r\n\t\tright: calc(var(--card-width) * 0.5);\r\n\t}\r\n\r\n\t.zhanting {\r\n\t\tright: calc(var(--card-width) * 2);\r\n\t}\r\n\r\n\t.control-btn>.corner {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\t--coner-width: calc(var(--card-width) * .4);\r\n\t\tposition: absolute;\r\n\t\tright: 0;\r\n\t\ttop: calc(0rpx - var(--coner-width) * .5);\r\n\t\tborder-radius: calc(var(--coner-width) / 2);\r\n\t\tbackground: red;\r\n\t\tcolor: white;\r\n\t\twidth: var(--coner-width);\r\n\t\theight: var(--coner-width);\r\n\t}\r\n\r\n\t.bar {\r\n\r\n\t\theight: var(--card-height);\r\n\t\twidth: calc(var(--card-width) * var(--bar-length));\r\n\t\tbackground: lightgray;\r\n\t\tposition: absolute;\r\n\t\tleft: var(--bar-left);\r\n\t\ttop: var(--bar-top);\r\n\t\tborder-radius: 10rpx;\r\n\t}\r\n\r\n\t.bar:before {\r\n\t\tcontent: '';\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground: white;\r\n\t\tfilter: blur(20rpx);\r\n\t}\r\n\r\n\t.welcome {\r\n\t\ttop: -120%;\r\n\t\tposition: relative;\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\r\n\t\tz-index: var(--welcome-z);\r\n\t\tbackground: url(../../static/miao-bg.webp) no-repeat;\r\n\t\tbackground-size: 100% 100%;\r\n\r\n\t\tdisplay: flex;\r\n\t\tflex-flow: column;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\ttransition: all 1s;\r\n\t}\r\n\r\n\t.welcome .game-name {\r\n\t\tcolor: white;\r\n\t\ttext-shadow: calc(var(--card-height) * .07) calc(var(--card-height) * .07) gray;\r\n\t\ttransform-origin: left;\r\n\t\tfont-weight: bolder;\r\n\t\tposition: absolute;\r\n\t}\r\n\r\n\t.show-welcome .welcome {\r\n\t\ttop: 0;\r\n\t}\r\n\r\n\t.water-mark {\r\n\t\tuser-select: all;\r\n\t\tposition: absolute;\r\n\t\tright: calc(var(--width) * .1);\r\n\t\tbottom: 1.5%;\r\n\t\tz-index: var(--water-mark-z);\r\n\t\tcolor: gray;\r\n\t}\r\n\t\r\n\t.game-over-mask {\r\n\t  --light-transparent: rgba(200, 200, 200, .6);\r\n\t  --dark-transparent: rgba(100, 100, 100, .8);\r\n\t  \r\n\t  top: -0rpx;\r\n\t  position: relative;\r\n\t  height: 100%;\r\n\t  width: 100%;\r\n\t  \r\n\t  z-index: var(--game-over-z);\r\n\t  background: linear-gradient(var(--light-transparent) 5%, var(--dark-transparent) 50%, var(--light-transparent) 100%);\r\n\t  \r\n\t  display: flex;\r\n\t  flex-flow: column;\r\n\t  justify-content: center;\r\n\t  align-items: center;\r\n\t  transition: all 1s;\r\n\t}\r\n\r\n\t.show-game-over .game-over-mask {\r\n\t\ttop: -100%;\r\n\t}\r\n\r\n\t.game-over-mask>.text {\r\n\t\ttop: -100%;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tfont-size: var(--card-width);\r\n\t\tcolor: white;\r\n\t}\r\n</style>","import mod from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1685588944515\n      var cssReload = require(\"C:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}